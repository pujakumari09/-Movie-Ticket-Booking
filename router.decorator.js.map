{"version":3,"sources":["components/auth/router.decorator.js"],"names":["angular","module","run","$rootScope","$location","Auth","$on","event","next","authenticate","hasRole","_","noop","then","has","preventDefault","isLoggedIn","path","is"],"mappings":"AAAA;;AAEA,CAAC,YAAW;;AAEVA,UAAQC,MAAR,CAAe,mCAAf,EACGC,GADH,CACO,UAASC,UAAT,EAAqBC,SAArB,EAAgCC,IAAhC,EAAsC;AACzC;AACAF,eAAWG,GAAX,CAAe,mBAAf,EAAoC,UAASC,KAAT,EAAgBC,IAAhB,EAAsB;AACxD,UAAI,CAACA,KAAKC,YAAV,EAAwB;AACtB;AACD;;AAED,UAAI,OAAOD,KAAKC,YAAZ,KAA6B,QAAjC,EAA2C;AACzCJ,aAAKK,OAAL,CAAaF,KAAKC,YAAlB,EAAgCE,EAAEC,IAAlC,EACGC,IADH,CACQ,eAAO;AACX,cAAIC,GAAJ,EAAS;AACP;AACD;;AAEDP,gBAAMQ,cAAN;AACA,iBAAOV,KAAKW,UAAL,CAAgBL,EAAEC,IAAlB,EACJC,IADI,CACC,cAAM;AACVT,sBAAUa,IAAV,CAAeC,KAAK,GAAL,GAAW,QAA1B;AACD,WAHI,CAAP;AAID,SAXH;AAYD,OAbD,MAaO;AACLb,aAAKW,UAAL,CAAgBL,EAAEC,IAAlB,EACGC,IADH,CACQ,cAAM;AACV,cAAIK,EAAJ,EAAQ;AACN;AACD;;AAEDX,gBAAMQ,cAAN;AACAX,oBAAUa,IAAV,CAAe,GAAf;AACD,SARH;AASD;AACF,KA7BD;AA8BD,GAjCH;AAkCD,CApCD","file":"router.decorator.js","sourcesContent":["'use strict';\n\n(function() {\n\n  angular.module('yeomanOnlineTicketBookingApp.auth')\n    .run(function($rootScope, $location, Auth) {\n      // Redirect to login if route requires auth and the user is not logged in, or doesn't have required role\n      $rootScope.$on('$routeChangeStart', function(event, next) {\n        if (!next.authenticate) {\n          return;\n        }\n\n        if (typeof next.authenticate === 'string') {\n          Auth.hasRole(next.authenticate, _.noop)\n            .then(has => {\n              if (has) {\n                return;\n              }\n\n              event.preventDefault();\n              return Auth.isLoggedIn(_.noop)\n                .then(is => {\n                  $location.path(is ? '/' : '/login');\n                });\n            });\n        } else {\n          Auth.isLoggedIn(_.noop)\n            .then(is => {\n              if (is) {\n                return;\n              }\n\n              event.preventDefault();\n              $location.path('/');\n            });\n        }\n      });\n    });\n})();\n"]}